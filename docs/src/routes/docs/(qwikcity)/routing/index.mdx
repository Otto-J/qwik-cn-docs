---
title: è·¯ç”± | Qwik City
description: äº†è§£ Qwik City ä¸­çš„è·¯ç”±ï¼Œå®ƒä¸å…¶ä»–åŸºäºæ–‡ä»¶ç³»ç»Ÿçš„è·¯ç”±æ¡†æ¶ï¼ˆå¦‚ Next.jsã€SvelteKitã€SolidStart æˆ– Remixï¼‰ç±»ä¼¼ã€‚
contributors:
  - manucorporat
  - nnelgxorz
  - the-r3aper7
  - Oyemade
  - mhevery
  - adamdbradley
  - wtlin1228
  - AnthonyPAlicea
  - hamatoyogi
  - jakovljevic-mladen
  - claudioshiver
  - maiieul
---

# è·¯ç”±

Qwik City ä¸­çš„è·¯ç”±æ˜¯åŸºäºæ–‡ä»¶ç³»ç»Ÿçš„ï¼Œç±»ä¼¼äº [Next.js](https://nextjs.org/docs/routing/introduction)ã€[SvelteKit](https://kit.svelte.dev/docs/routing)ã€[SolidStart](https://start.solidjs.com/core-concepts/routing) æˆ– [Remix](https://remix.run/docs/en/main/guides/routing)ã€‚`src/routes` ç›®å½•ä¸­çš„æ–‡ä»¶å’Œç›®å½•åœ¨åº”ç”¨ç¨‹åºçš„è·¯ç”±ä¸­èµ·åˆ°äº†ä½œç”¨ã€‚

- **ğŸ“‚ ç›®å½•ï¼š** å®šä¹‰è·¯ç”±å™¨è¦åŒ¹é…çš„ URL ç‰‡æ®µã€‚
- **ğŸ“„ `index.tsx/mdx` æ–‡ä»¶ï¼š** å®šä¹‰ä¸€ä¸ª[é¡µé¢](/docs/pages/)ã€‚
- **ğŸ“„ `index.ts` æ–‡ä»¶ï¼š** å®šä¹‰ä¸€ä¸ª[ç«¯ç‚¹](/docs/endpoints/)ã€‚
- **ğŸ–¼ï¸ `layout.tsx` æ–‡ä»¶ï¼š** å®šä¹‰åµŒå¥—çš„[å¸ƒå±€](/docs/layout/)å’Œ/æˆ–[ä¸­é—´ä»¶](/docs/middleware/)ã€‚

<video autoplay playsinline muted loop>
 <source src="https://cdn.builder.io/o/assets%2FYJIGb4i01jvw0SRdL5Bt%2Fabf8f471ba884b938d0863d85ed4c50f%2Fcompressed?apiKey=YJIGb4i01jvw0SRdL5Bt&token=abf8f471ba884b938d0863d85ed4c50f&alt=media&optimized=true"/>
</video>


## åŸºäºç›®å½•çš„è·¯ç”±

åªæœ‰ç›®å½•åç§°ç”¨äºåŒ¹é…ä¼ å…¥çš„è¯·æ±‚ä¸é¡µé¢/ç«¯ç‚¹/ä¸­é—´ä»¶ã€‚

ä¾‹å¦‚ï¼Œå¦‚æœåœ¨ `src/routes/some/path/index.tsx` ä¸­æœ‰ä¸€ä¸ªæ–‡ä»¶ï¼Œåˆ™å®ƒå°†æ˜ å°„åˆ° URL è·¯å¾„ `https://example.com/some/path`ã€‚

```bash title="ç›®å½•å¸ƒå±€"
src/
â””â”€â”€ routes/
    â”œâ”€â”€ contact/
    â”‚   â””â”€â”€ index.mdx         # https://example.com/contact
    â”œâ”€â”€ about/
    â”‚   â””â”€â”€ index.md          # https://example.com/about
    â”œâ”€â”€ docs/
    â”‚   â””â”€â”€ [id]/
    â”‚       â””â”€â”€ index.ts      # https://example.com/docs/1234
    â”‚                         # https://example.com/docs/anything
    â”œâ”€â”€ [...catchall]/
    â”‚   â””â”€â”€ index.tsx         # https://example.com/anything/else/that/didnt/match
    â”‚
    â””â”€â”€ layout.tsx            # æ­¤å¸ƒå±€ç”¨äºæ‰€æœ‰é¡µé¢
```

- **`[id]`** æ˜¯è¡¨ç¤ºåŠ¨æ€è·¯ç”±ç‰‡æ®µçš„ç›®å½•ï¼Œåœ¨æ­¤ç¤ºä¾‹ä¸­ï¼Œ`id` æ˜¯ç”± `useLocation().params.id` è®¿é—®çš„å­—ç¬¦ä¸²å‚æ•°ã€‚
- **`[...catchall]`** æ˜¯è¡¨ç¤ºåŠ¨æ€æ•è·æ‰€æœ‰è·¯ç”±çš„ç›®å½•ï¼Œåœ¨æ­¤ç¤ºä¾‹ä¸­ï¼Œ`catchall` æ˜¯ç”± `useLocation().params.catchall` è®¿é—®çš„å­—ç¬¦ä¸²å‚æ•°ã€‚
- **`index.tsx|mdx` æ–‡ä»¶** æ˜¯é¡µé¢/ç«¯ç‚¹/ä¸­é—´ä»¶ã€‚
- **`layout.tsx` æ–‡ä»¶** æ˜¯å¸ƒå±€ã€‚

### åŠ¨æ€è·¯ç”±ç‰‡æ®µ

ä½¿ç”¨æ–¹æ‹¬å·ï¼ˆ`[]`ï¼‰å‘½åçš„ç‰¹æ®Šç›®å½•ï¼Œä¾‹å¦‚ `[paramName]` å’Œ `[...catchAll]`ï¼Œå¯ç”¨äºåŒ¹é…åŠ¨æ€çš„è·¯ç”±ç‰‡æ®µï¼š

```bash title="ç›®å½•å¸ƒå±€"
src/routes/blog/index.tsx â†’ /blog
src/routes/user/[username]/index.tsx â†’ /user/:username (/user/foo)
src/routes/post/[...all]/index.tsx â†’ /post/* (/post/2020/id/title)
```

```bash title="ç›®å½•å¸ƒå±€"
src/
â””â”€â”€ routes/
    â”œâ”€â”€ blog/
    â”‚   â””â”€â”€ index.tsx         # https://example.com/blog
    â”œâ”€â”€ post/
    â”‚   â””â”€â”€ [...all]/
    â”‚       â””â”€â”€ index.tsx     # https://example.com/post/2020/id/title
    â””â”€â”€ user/
        â””â”€â”€ [username]/
            â””â”€â”€ index.tsx     # https://example.com/user/foo
```

> æ–‡ä»¶å¤¹ `[username]` å¯ä»¥æ˜¯æ•°æ®åº“ä¸­çš„æ•°åƒä¸ªç”¨æˆ·ä¹‹ä¸€ã€‚ä¸ºæ¯ä¸ªç”¨æˆ·åˆ›å»ºä¸€ä¸ªè·¯ç”±æ˜¯ä¸åˆ‡å®é™…çš„ã€‚ç›¸åï¼Œæ‚¨éœ€è¦å®šä¹‰ä¸€ä¸ªè·¯ç”±å‚æ•°ï¼ˆURL çš„ä¸€éƒ¨åˆ†ï¼‰ï¼Œç”¨äºæå– `[username]`ã€‚

```tsx title="src/routes/user/[username]/index.tsx"
import { component$ } from '@builder.io/qwik';
import { useLocation } from '@builder.io/qwik-city';

export default component$(() => {
  const loc = useLocation();
  return <div>Hello {loc.params.username}!</div>;
});
```

## `index` æ–‡ä»¶

åœ¨ `src/routes` ç›®å½•ä¸­ï¼Œæ‰€æœ‰åä¸º `index` çš„æ–‡ä»¶éƒ½è¢«è§†ä¸ºé¡µé¢/ç«¯ç‚¹/ä¸­é—´ä»¶ï¼ŒQwik æ”¯æŒä»¥ä¸‹æ‰©å±•åï¼š`.ts`ã€`.tsx`ã€`.md` å’Œ `.mdx`ã€‚

é¡µé¢/ç«¯ç‚¹/ä¸­é—´ä»¶æ˜¯è·¯ç”±æ ‘çš„å¶èŠ‚ç‚¹ï¼Œå³**å¤„ç†è¯·æ±‚å¹¶è¿”å› HTTP å“åº”çš„æ¨¡å—**ã€‚

### é¡µé¢ `index.tsx`

å½“ `index.tsx` æˆ– `index.ts` å¯¼å‡ºä¸€ä¸ª Qwik ç»„ä»¶ä½œä¸ºé»˜è®¤å¯¼å‡ºæ—¶ï¼ŒQwik City å°†æ¸²æŸ“è¯¥ç»„ä»¶å¹¶è¿”å›ä¸€ä¸ª HTML å“åº”ä½œä¸ºç½‘é¡µã€‚

```tsx title="src/routes/index.tsx"
import { component$ } from '@builder.io/qwik';

export default component$(() => {
  return <h1>Hello World</h1>;
});
```

### ç«¯ç‚¹ `index.ts`

`index.ts` ä¹Ÿå¯ä»¥ç›´æ¥è®¿é—® HTTP è¯·æ±‚å¹¶è¿”å›ä¸€ä¸ªåŸå§‹çš„ HTTP å“åº”ï¼Œè€Œä¸æ¶‰åŠä»»ä½• Qwik ç»„ä»¶ã€‚é€šè¿‡å¯¼å‡ºä¸€ä¸ª `onRequest` æ–¹æ³•æˆ– `onGet`ã€`onPost`ã€`onPut`ã€`onDelete` æ–¹æ³•æ¥å®ç°ã€‚

```tsx title="src/routes/index.ts"
import type { RequestHandler } from '@builder.io/qwik-city';

export const onGet: RequestHandler = ({ json }) => {
  json(200, { message: 'Hello World' });
};
```

> æ³¨æ„ï¼Œåœ¨æœ€åä¸€ä¸ªç¤ºä¾‹ä¸­ï¼Œæ²¡æœ‰é»˜è®¤å¯¼å‡ºã€‚è¿™æ˜¯å› ä¸ºæˆ‘ä»¬ä¸æ˜¯æ¸²æŸ“ Qwik ç»„ä»¶ï¼Œè€Œæ˜¯ç›´æ¥å¤„ç†è¯·æ±‚å¹¶è¿”å› JSON å“åº”ã€‚è¿™å¯¹äºå®ç° RESTful API æˆ–ä»»ä½•å…¶ä»–ç±»å‹çš„ HTTP ç«¯ç‚¹éå¸¸æœ‰ç”¨ã€‚

### é¡µé¢ + ç«¯ç‚¹

æ­£å¦‚æ‚¨åœ¨ Qwik City ä¸­æ‰€çœ‹åˆ°çš„ï¼Œé¡µé¢å’Œç«¯ç‚¹ä¹‹é—´æ²¡æœ‰æ˜ç¡®çš„åˆ†ç¦»ï¼Œä¸¤è€…éƒ½æ˜¯å¯¼å‡ºä¸€ä¸ª Qwik ç»„ä»¶æˆ–ä¸€ä¸ª `onRequest` æ–¹æ³•çš„ `index.tsx` æ–‡ä»¶ã€‚ä½†æ˜¯ï¼Œå¯ä»¥å°†è¿™ä¸¤ç§æ–¹æ³•ç»“åˆèµ·æ¥ä½¿ç”¨ã€‚ä¾‹å¦‚ï¼Œæ‚¨å¯ä»¥å¯¼å‡ºä¸€ä¸ª `onRequest` æ–¹æ³•æ¥å¤„ç†è¯·æ±‚ï¼Œç„¶åæ¸²æŸ“ä¸€ä¸ª Qwik ç»„ä»¶ã€‚

```tsx title="src/routes/index.tsx"
import { component$ } from '@builder.io/qwik';
import type { RequestHandler } from '@builder.io/qwik-city';

export const onRequest: RequestHandler = ({ headers, query, json }) => {
  headers.set('Cache-Control', 'private');
  if (query.get('format') === 'json') {
    json(200, { message: 'Hello World' });
  }
};

export default component$(() => {
  return <h1>Hello World</h1>;
});
```

> åœ¨æ­¤ç¤ºä¾‹ä¸­ï¼Œè¯·æ±‚å¤„ç†ç¨‹åºå°†å§‹ç»ˆå°† `Cache-Control` æ ‡å¤´è®¾ç½®ä¸º `private`ï¼Œå¹¶ä¸”é¡µé¢å°†å‘ˆç°ä¸º HTML é¡µé¢ï¼Œä½†æ˜¯å¦‚æœè¯·æ±‚åŒ…å« `format=json` æŸ¥è¯¢å‚æ•°ï¼Œåˆ™ç«¯ç‚¹å°†è¿”å› JSON å“åº”ã€‚

## `layout.tsx` æ–‡ä»¶

å¸ƒå±€æ¨¡å—ä¸ `index` æ–‡ä»¶éå¸¸ç›¸ä¼¼ï¼Œä¸¤è€…éƒ½å¯ä»¥å¤„ç†è¯·æ±‚å¹¶æ¸²æŸ“ Qwik ç»„ä»¶ï¼Œä½†æ˜¯å¸ƒå±€æ—¨åœ¨åƒä¸­é—´ä»¶ä¸€æ ·å·¥ä½œï¼Œå…è®¸ä¸ºä¸€ç»„è·¯ç”±å…±äº« UI å’Œè¯·æ±‚å¤„ç†ï¼ˆä¸­é—´ä»¶ï¼‰ã€‚

é€šå¸¸ï¼Œä¸åŒçš„é¡µé¢éœ€è¦ä¸€äº›å…±åŒçš„è¯·æ±‚å¤„ç†å¹¶å…±äº«ä¸€äº› UIã€‚ä¾‹å¦‚ï¼Œæƒ³è±¡ä¸€ä¸ªä»ªè¡¨æ¿ç½‘ç«™ï¼Œå…¶ä¸­æ‰€æœ‰é¡µé¢éƒ½åœ¨ `/admin/*` ç›®å½•ä¸‹ï¼š

- **å…±äº«çš„è¯·æ±‚å¤„ç†ï¼š** åœ¨æ¸²æŸ“é¡µé¢ä¹‹å‰ï¼Œéœ€è¦éªŒè¯è¯·æ±‚çš„ cookieï¼Œå¦åˆ™æ¸²æŸ“ä¸€ä¸ªç©ºç™½çš„ 401 é¡µé¢ã€‚
- **å…±äº«çš„ UIï¼š** æ‰€æœ‰é¡µé¢å…±äº«ä¸€ä¸ªå¸¸è§çš„é¡µçœ‰ï¼Œæ˜¾ç¤ºç”¨æˆ·çš„åç§°å’Œä¸ªäººèµ„æ–™å›¾ç‰‡ã€‚

è€Œä¸æ˜¯åœ¨æ¯ä¸ªè·¯ç”±ä¸­é‡å¤ç›¸åŒçš„ä»£ç ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¸ƒå±€æ¥è‡ªåŠ¨é‡ç”¨å¸¸è§éƒ¨åˆ†ï¼Œå¹¶æ·»åŠ ä¸­é—´ä»¶åˆ°è·¯ç”±ä¸­ã€‚

ä»¥æ­¤ `src/routes` ç›®å½•ä¸ºä¾‹ï¼š

```bash title="ç›®å½•å¸ƒå±€"
src/
â””â”€â”€ routes/
    â”œâ”€â”€ admin/
    â”‚   â”œâ”€â”€ layout.tsx  <-- æ­¤å¸ƒå±€ç”¨äº /admin/* ä¸‹çš„æ‰€æœ‰é¡µé¢
    â”‚   â””â”€â”€ index.tsx
    â”œâ”€â”€ layout.tsx      <-- æ­¤å¸ƒå±€ç”¨äºæ‰€æœ‰é¡µé¢
    â””â”€â”€ index.tsx
```

### ä¸­é—´ä»¶å¸ƒå±€

ç”±äºå¸ƒå±€å¯ä»¥ä½¿ç”¨ `onRequest` æˆ– `onGet`ã€`onPost`ã€`onPut`ã€`onDelete` å®ç°è¯·æ±‚å¤„ç†ï¼Œå› æ­¤å®ƒä»¬å¯ä»¥ç”¨äºå®ç°ä¸­é—´ä»¶ï¼Œä¾‹å¦‚ï¼Œåœ¨æ¸²æŸ“é¡µé¢ä¹‹å‰éªŒè¯è¯·æ±‚çš„ cookieã€‚

å¯¹äºè·¯ç”± `https://example.com/admin`ï¼Œ`onRequest` æ–¹æ³•å°†æŒ‰ä»¥ä¸‹é¡ºåºæ‰§è¡Œï¼š

1. `src/routes/layout.tsx` çš„ `onRequest`
2. `src/routes/admin/layout.tsx` çš„ `onRequest`
3. `src/routes/admin/index.tsx` çš„ `onRequest`
4. `src/routes/admin/index.tsx` çš„ç»„ä»¶

åœ¨ `src/routes/index.tsx` ä¸­çš„ `onRequest` å¤„ç†ç¨‹åºä¸ä¼šè¢«æ‰§è¡Œã€‚

### åµŒå¥—å¸ƒå±€

å¸ƒå±€è¿˜**æä¾›äº†ä¸€ç§å‘å‘ˆç°çš„é¡µé¢æ·»åŠ å…±äº« UI**çš„æ–¹æ³•ã€‚ä¾‹å¦‚ï¼Œå¦‚æœè¦ä¸ºæ‰€æœ‰è·¯ç”±æ·»åŠ ä¸€ä¸ªå¸¸è§çš„é¡µçœ‰ï¼Œå¯ä»¥å°† `Header` ç»„ä»¶æ·»åŠ åˆ°æ ¹å¸ƒå±€ä¸­ã€‚

å¯¹äºç»™å®šçš„ç¤ºä¾‹ï¼ŒQwik ç»„ä»¶å°†æŒ‰ä»¥ä¸‹é¡ºåºå‘ˆç°ï¼š

1. `src/routes/layout.tsx` çš„ç»„ä»¶
2. `src/routes/admin/layout.tsx` çš„ç»„ä»¶
3. `src/routes/admin/index.tsx` çš„ç»„ä»¶

```tsx
<RootLayout>
  <AdminLayout>
    <AdminPage />
  </AdminLayout>
</RootLayout>
```

## SPA å¯¼èˆª

ä½¿ç”¨ Qwikï¼ŒMPA å’Œ SPA ä¹‹é—´çš„åŒºåˆ«æ¶ˆå¤±äº†ï¼›æ¯ä¸ªåº”ç”¨ç¨‹åºå¯ä»¥åŒæ—¶æ˜¯ MPA å’Œ SPAã€‚every app can be both at the same time.
The choice is no longer an architectural design determined at the beginning of the project,
instead, this decision can be made for every link.

Qwik å¯ä»¥ä½¿ç”¨ `<Link>` ç»„ä»¶å’Œ `useNavigate()` é’©å­æ¥å‘èµ· SPA åˆ·æ–°æˆ–é¡µé¢ä¹‹é—´çš„å¯¼èˆªã€‚
These can be used to initiate an SPA refresh or navigation between pages.

`Link` ç»„ä»¶æ˜¯å¯¼èˆªçš„æ¨èæ–¹å¼ï¼Œå®ƒä½¿ç”¨ HTML çš„ `<a>` æ ‡ç­¾ï¼Œ
è¿™æ˜¯åœ¨é¡µé¢ä¹‹é—´ç§»åŠ¨æœ€å¯è®¿é—®çš„æ–¹å¼ã€‚
ä½†æ˜¯ï¼Œå¦‚æœéœ€è¦ä»¥ç¼–ç¨‹æ–¹å¼å¯¼èˆªï¼Œå¯ä»¥ä½¿ç”¨ `useNavigate()` é’©å­ã€‚

```tsx
import { component$ } from '@builder.io/qwik';
import { Link, useNavigate } from '@builder.io/qwik-city';

export default component$(() => {
  const nav = useNavigate();
  return (
    <div>
      <Link href="/about">Aboutï¼ˆé¦–é€‰ï¼‰</Link>
      <button onClick$={() => nav('/about')}>About</button>
    </div>
  );
});
```

> `Link` ç»„ä»¶åœ¨å†…éƒ¨ä½¿ç”¨ `useNavigate()` é’©å­ [å®ç°](https://github.com/BuilderIO/qwik/blob/e452582f4728cbcb7bf85d03293e757302286683/packages/qwik-city/runtime/src/link-component.tsx#L33)ã€‚

### åˆ·æ–°

ä½¿ç”¨å…·æœ‰ `reload` å±æ€§çš„ `Link` å¯ä»¥åˆ·æ–°å½“å‰é¡µé¢ã€‚
ä½ è¿˜å¯ä»¥è°ƒç”¨ `useNavigate()` é’©å­çš„ `nav()` å‡½æ•°ï¼Œä¸å¸¦å‚æ•°ã€‚

```tsx
import { component$ } from '@builder.io/qwik';
import { Link, routeLoader$, useNavigate } from '@builder.io/qwik-city';

export const useServerTime = routeLoader$(() => {
  // è¿™å°†åœ¨é¡µé¢åˆ·æ–°æ—¶åœ¨æœåŠ¡å™¨ä¸Šé‡æ–°æ‰§è¡Œã€‚
  return Date.now();
});

export default component$(() => {
  const nav = useNavigate();
  const serverTime = useServerTime();

  return (
    <div>
      <Link reload>Refresh (better accessibility)</Link>
      <button onClick$={() => nav()}>Refresh</button>
      <p>Server time: {serverTime.value}</p>
    </div>
  );
});
```

> å½“é¡µé¢åˆ·æ–°æ—¶ï¼Œæ‰€æœ‰åŒ¹é…çš„ `routeLoader$` å’ŒæœåŠ¡å™¨å¤„ç†ç¨‹åºï¼ˆ`onRequest`ï¼‰å°†åœ¨æœåŠ¡å™¨ä¸Šé‡æ–°æ‰§è¡Œï¼Œå¹¶ç›¸åº”åœ°é‡æ–°å‘ˆç° UIã€‚

> åœ¨åˆ·æ–°é¡µé¢æ—¶ï¼Œç›´åˆ°é¡µé¢å®Œå…¨å‘ˆç°ï¼Œ`useLocation()` çš„ `isNavigating` å¸ƒå°”å€¼å°†ä¸º `true`ã€‚

### é¢„å–

`Link` ç»„ä»¶çš„ `prefetch` å±æ€§å¯ç”¨äºæé«˜åº”ç”¨ç¨‹åºçš„æ„ŸçŸ¥æ€§èƒ½ã€‚å°½ç®¡ Qwik é¡µé¢åœ¨å»¶è¿ŸåŠ è½½ JavaScript æ–¹é¢è¡¨ç°å‡ºè‰²ï¼Œä½†è¿™ä¸ªåŠŸèƒ½å¯¹äºå†…å®¹å¯†é›†çš„é¡µé¢æˆ–éœ€è¦ç­‰å¾…æ•°æ®åº“æˆ– API è°ƒç”¨çš„ SSR é¡µé¢éå¸¸æœ‰ç”¨ã€‚

```tsx
<Link prefetch href="/about">About</Link>
```

åªéœ€æ·»åŠ  `prefetch` å±æ€§ï¼Œæ‚¨çš„ `Link` ç»„ä»¶å°†åœ¨ç”¨æˆ·æ‚¬åœåœ¨é“¾æ¥ä¸Šæ—¶ç«‹å³å¼€å§‹é¢„å–é¡µé¢ã€‚å¦‚æœåº”ç”¨ç¨‹åºåœ¨ç”¨æˆ·å•å‡»é“¾æ¥æ—¶å®Œæˆé¢„å–ï¼Œä¸‹ä¸€ä¸ªé¡µé¢å°†ç«‹å³æ˜¾ç¤ºã€‚

### æ»šåŠ¨æ¢å¤ - need review

Qwik æä¾›äº†æœ€ä½³çš„æ»šåŠ¨æ¢å¤åŠŸèƒ½ï¼Œå‡ ä¹ä¸åŸç”Ÿæµè§ˆå™¨ä½“éªŒç›¸åŒã€‚
æ‚¨çš„ç”¨æˆ·åº”è¯¥è·å¾—ä¸ MPA ä¸­åŸç”Ÿä½“éªŒå®Œå…¨ç›¸åŒçš„ä½“éªŒï¼Œ
åªæ˜¯å¤šäº† SPA çš„æ‰€æœ‰é™„åŠ ä¼˜åŠ¿ã€‚

åœ¨ä½¿ç”¨ä¸Šè¿°ä»»ä½•ä¸€ç§æ–¹æ³•å¯¼èˆªåï¼Œç”¨æˆ·å°†è‡ªåŠ¨å‡çº§ä¸º SPAã€‚
è¿™æ„å‘³ç€å½“å‰é¡µé¢å’Œä»–ä»¬æ¥è‡ªçš„é¡µé¢ç°åœ¨éƒ½ä¸ SPA ä¸Šä¸‹æ–‡ç›¸å…³è”ã€‚

å¦‚æœç”¨æˆ·éšåç‚¹å‡»å¸¸è§„çš„ `<a>` æ ‡ç­¾ï¼Œå®ƒä»¬å°†æ‰§è¡Œå¸¸è§„å¯¼èˆªã€‚è¿™ä¸ªæ–°é¡µé¢å°†æ²¡æœ‰ SPA ä¸Šä¸‹æ–‡ï¼Œå¹¶ä¸”å®é™…ä¸Šè¢«é™çº§ä¸º MPAã€‚
æ‚¨å¯ä»¥æ ¹æ®éœ€è¦åœ¨è¿™ä¸¤è€…ä¹‹é—´åˆ‡æ¢ï¼Œç”¨æˆ·çš„ä½“éªŒå°†åœ¨ MPA å’Œ SPA ä¹‹é—´æ— ç¼åˆ‡æ¢ï¼Œ
å°±åƒå®ƒä»¬éƒ½æ˜¯ç›¸åŒçš„ä¸€æ ·ã€‚

å½“ç”¨æˆ·é‡æ–°è®¿é—®å¯ç”¨äº† SPA çš„å†å²è®°å½•æ¡ç›®æ—¶ï¼Œä¾‹å¦‚åˆ·æ–°ã€åé€€/å‰è¿›æŒ‰é’®ã€æµè§ˆå™¨ä¼šè¯é‡å¯ç­‰ï¼Œ
Qwik å°†è‡ªåŠ¨æ¢å¤ä»–ä»¬çš„æ»šåŠ¨ä½ç½®ï¼Œå¹¶æ ¹æ®éœ€è¦å°†è‡ªèº«å¼•å¯¼å› SPA ä¸Šä¸‹æ–‡ä¸­ã€‚

> ç”¨äºæä¾›è¿™ç§å¼ºå¤§ä½“éªŒçš„è„šæœ¬åœ¨ç”¨æˆ·çš„æµè§ˆå™¨ä¸­æ°¸è¿œä¸ä¼šåŠ è½½ï¼Œä¹Ÿæ°¸è¿œä¸ä¼šå‘é€ç»™ç”¨æˆ·çš„æµè§ˆå™¨ï¼Œé™¤éå†å²è®°å½•æ¡ç›®å…·æœ‰ SPA ä¸Šä¸‹æ–‡ã€‚
> è¿™å°±æ˜¯ Qwik çš„é­”åŠ›æ‰€åœ¨ã€‚

> Qwik çš„æ»šåŠ¨æ¢å¤å®Œå…¨åŸºäº `history`ã€‚è¿™ä¸è®¸å¤šå…¶ä»–æ¡†æ¶ä¸åŒï¼Œåè€…ä¾èµ–äºè¯¸å¦‚ `sessionStorage` ç­‰å†…å®¹ã€‚

Qwik è®°ä½å¹¶æ¢å¤æ»šåŠ¨ä½ç½®çš„èƒ½åŠ›éå¸¸å¼ºå¤§ï¼Œå¯ä»¥ç»å—ä»æµè§ˆå™¨ä¼šè¯é‡å¯åˆ°ç”¨æˆ·æ¸…é™¤æµè§ˆå™¨æ•°æ®çš„ä¸€åˆ‡è€ƒéªŒï¼Œè€Œè¿™å¯¹äºè®¸å¤šå…¶ä»–æ¡†æ¶æ¥è¯´å¹¶éå¦‚æ­¤ã€‚

> **åœ¨ SPA ä¸­ä½¿ç”¨ `pushState()` å’Œ `replaceState()` çš„æ³¨æ„äº‹é¡¹ï¼š**


need review.



>
> åœ¨å…·æœ‰ SPA ä¸Šä¸‹æ–‡çš„é¡µé¢ä¸Šï¼ŒQwik å°†åœ¨ `history` å…¨å±€å¯¹è±¡ä¸Šä¿®è¡¥ `pushState()` å’Œ `replaceState()` å‡½æ•°ã€‚
> è¿™æ˜¯ä¸ºäº†ç¡®ä¿æ‚¨ä½œä¸ºå¼€å‘äººå‘˜æ·»åŠ çš„ä»»ä½•è‡ªå®šä¹‰çŠ¶æ€ä¹Ÿæ¥æ”¶åˆ° SPA ä¸Šä¸‹æ–‡ã€‚
>
> åœ¨ä¿®è¡¥è¿™äº›å‡½æ•°æ—¶ï¼Œæ‚¨ `push` æˆ– `replace` çš„çŠ¶æ€åº”å§‹ç»ˆæ˜¯ä¸€ä¸ªå®é™…çš„ `Object` ç±»å‹ã€‚
> è¿™æ˜¯å› ä¸º Qwik éœ€è¦èƒ½å¤Ÿè‡ªåŠ¨å°† SPA ä¸Šä¸‹æ–‡é™„åŠ åˆ°çŠ¶æ€ä½œä¸ºå±æ€§ã€‚
>
> å¦‚æœæä¾›çš„å€¼ä¸æ˜¯å¯¹è±¡ï¼Œåˆ™ Qwik å°†ä¸ºçŠ¶æ€åˆ›å»ºä¸€ä¸ªæ–°å¯¹è±¡ï¼Œå¹¶å°†æ‚¨æä¾›çš„å€¼æ·»åŠ åˆ°ä¸€ä¸ªæ–°çš„é”®ä¸­ï¼š
> `{ _data: <your_value> }`
>
> å½“å‘ç”Ÿè¿™ç§æƒ…å†µæ—¶ï¼ŒQwik è¿˜å°†åœ¨æµè§ˆå™¨çš„æ§åˆ¶å°ä¸­ä»¥ `dev` æ¨¡å¼è­¦å‘Šæ‚¨ã€‚


## è¯·æ±‚äº‹ä»¶

æ¯ä¸ªè¯·æ±‚å¤„ç†ç¨‹åºï¼ˆä¾‹å¦‚ `onRequest`ã€`onGet`ã€`onPost` ç­‰ï¼‰éƒ½ä½œä¸ºç¬¬ä¸€ä¸ªå‚æ•°ä¼ é€’ç»™ `RequestEvent` å¯¹è±¡ã€‚`RequestEvent` å¯¹è±¡åŒ…å«ç”¨äºè·å–å’Œè®¾ç½®æœåŠ¡å™¨è¯·æ±‚å’Œå“åº”çš„å®ç”¨å‡½æ•°å’Œå±æ€§ã€‚è¯¥å¯¹è±¡åŒ…å«ä»¥ä¸‹å±æ€§ï¼š

- `basePathname`ï¼šè¯·æ±‚çš„åŸºæœ¬è·¯å¾„åï¼Œå¯ä»¥åœ¨æ„å»ºæ—¶é…ç½®ã€‚é»˜è®¤ä¸º `/`ã€‚
- `cacheControl`ï¼šè®¾ç½® [Cache-Control](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Cache-Control) å“åº”å¤´çš„ä¾¿æ·å‡½æ•°ã€‚
- `cookie`ï¼šHTTP è¯·æ±‚å’Œå“åº”çš„ [cookie](https://developer.mozilla.org/en-US/docs/Web/HTTP/Cookies)ã€‚ä½¿ç”¨ `get()` æ–¹æ³•æ£€ç´¢è¯·æ±‚ cookie å€¼ã€‚ä½¿ç”¨ `set()` æ–¹æ³•è®¾ç½®å“åº” cookie å€¼ã€‚
- `env`ï¼šå¹³å°æä¾›çš„ç¯å¢ƒå˜é‡ã€‚
- `error`ï¼šè°ƒç”¨æ—¶ï¼Œå“åº”å°†ç«‹å³ä»¥ç»™å®šçš„çŠ¶æ€ä»£ç ç»“æŸã€‚è¿™å¯¹äºä»¥ `404` ç»“æŸå“åº”å¹¶åœ¨è·¯ç”±ç›®å½•ä¸­ä½¿ç”¨ 404 å¤„ç†ç¨‹åºéå¸¸æœ‰ç”¨ã€‚æœ‰å…³åº”ä½¿ç”¨å“ªä¸ªçŠ¶æ€ä»£ç ï¼Œè¯·å‚é˜…[çŠ¶æ€ä»£ç ](https://developer.mozilla.org/en-US/docs/Web/HTTP/Status)ã€‚
- `getWritableStream`ï¼šä½çº§è®¿é—® HTTP å“åº”æµçš„å†™å…¥ã€‚ä¸€æ—¦è°ƒç”¨äº† `getWritableStream()`ï¼ŒçŠ¶æ€å’Œæ ‡å¤´å°†æ— æ³•å†ä¿®æ”¹ï¼Œå¹¶å°†é€šè¿‡ç½‘ç»œå‘é€ã€‚
- `headers`ï¼šHTTP [å“åº”å¤´](https://developer.mozilla.org/en-US/docs/Glossary/Response_header)ã€‚
- `html`ï¼šå‘é€ HTML å“åº”çš„ä¾¿æ·æ–¹æ³•ã€‚å“åº”å°†è‡ªåŠ¨å°† `Content-Type` æ ‡å¤´è®¾ç½®ä¸º `text/html; charset=utf-8`ã€‚åªèƒ½è°ƒç”¨ä¸€æ¬¡ `html()` å“åº”ã€‚
- `json`ï¼šå°†æ•°æ®è½¬æ¢ä¸º JSON å­—ç¬¦ä¸²å¹¶åœ¨å“åº”ä¸­å‘é€ã€‚å“åº”å°†è‡ªåŠ¨å°† `Content-Type` æ ‡å¤´è®¾ç½®ä¸º `application/json; charset=utf-8`ã€‚åªèƒ½è°ƒç”¨ä¸€æ¬¡ `json()` å“åº”ã€‚
- `locale`ï¼šå†…å®¹æ‰€åœ¨çš„åŒºåŸŸè®¾ç½®ã€‚å¯ä»¥ä½¿ç”¨ `getLocale()` ä»é€‰å®šçš„æ–¹æ³•ä¸­æ£€ç´¢åŒºåŸŸè®¾ç½®å€¼ã€‚
- `method`ï¼šHTTP è¯·æ±‚çš„ [æ–¹æ³•](https://developer.mozilla.org/en-US/docs/Web/HTTP/Methods) å€¼ã€‚
- `next`ï¼šè°ƒç”¨ä¸‹ä¸€ä¸ªè¯·æ±‚å¤„ç†ç¨‹åºã€‚è¿™å¯¹äºä¸­é—´ä»¶éå¸¸æœ‰ç”¨ã€‚
- `params`ï¼šä»å½“å‰ URL è·¯å¾„æ®µè§£æå‡ºçš„ URL è·¯å¾„å‚æ•°ã€‚ä½¿ç”¨ `query` æ¥ä»£æ›¿æ£€ç´¢æŸ¥è¯¢å­—ç¬¦ä¸²æœç´¢å‚æ•°ã€‚
- `parseBody`ï¼šæ­¤æ–¹æ³•å°†æ£€æŸ¥è¯·æ±‚æ ‡å¤´ä¸­çš„ `Content-Type` æ ‡å¤´å¹¶ç›¸åº”åœ°è§£æè¯·æ±‚æ­£æ–‡ã€‚å®ƒæ”¯æŒ `application/json`ã€`application/x-www-form-urlencoded` å’Œ `multipart/form-data` å†…å®¹ç±»å‹ã€‚å¦‚æœæœªè®¾ç½® `Content-Type` æ ‡å¤´ï¼Œå®ƒå°†è¿”å› `null`ã€‚
- `pathname`ï¼šURL è·¯å¾„åå€¼ã€‚ä¸åŒ…æ‹¬åè®®ã€åŸŸåã€æŸ¥è¯¢å­—ç¬¦ä¸²ï¼ˆæœç´¢å‚æ•°ï¼‰æˆ–å“ˆå¸Œã€‚
- `platform`ï¼šç‰¹å®šäºå¹³å°çš„æ•°æ®å’Œå‡½æ•°ã€‚
- `query`ï¼šURL æŸ¥è¯¢å­—ç¬¦ä¸² [URLSearchParams](https://developer.mozilla.org/en-US/docs/Web/API/URLSearchParams) å€¼ã€‚ä½¿ç”¨ `params` æ¥ä»£æ›¿æ£€ç´¢åœ¨ URL è·¯å¾„ä¸­æ‰¾åˆ°çš„è·¯ç”±å‚æ•°ã€‚
- `redirect`ï¼šè¦é‡å®šå‘çš„ URLã€‚è°ƒç”¨æ—¶ï¼Œå“åº”å°†ç«‹å³ä»¥æ­£ç¡®çš„é‡å®šå‘çŠ¶æ€å’Œæ ‡å¤´ç»“æŸã€‚æœ‰å…³åº”ä½¿ç”¨å“ªä¸ªçŠ¶æ€ä»£ç ï¼Œè¯·å‚é˜…[é‡å®šå‘](https://developer.mozilla.org/en-US/docs/Web/HTTP/Redirections)ã€‚
- `request`ï¼šHTTP [è¯·æ±‚](https://developer.mozilla.org/en-US/docs/Web/API/Request)ã€‚
- `send`ï¼šå‘é€å“åº”æ­£æ–‡ã€‚ä½¿ç”¨ `send()` æ—¶ï¼Œ`Content-Type` å“åº”å¤´ä¸ä¼šè‡ªåŠ¨è®¾ç½®ï¼Œå¿…é¡»æ‰‹åŠ¨è®¾ç½®ã€‚åªèƒ½è°ƒç”¨ä¸€æ¬¡ `send()` å“åº”ã€‚
- `sharedMap`ï¼šæ‰€æœ‰è¯·æ±‚å¤„ç†ç¨‹åºä¹‹é—´å…±äº«çš„å…±äº« Mapã€‚æ¯ä¸ª HTTP è¯·æ±‚éƒ½ä¼šè·å¾—å…±äº« Map çš„æ–°å®ä¾‹ã€‚å…±äº« Map å¯¹äºåœ¨è¯·æ±‚å¤„ç†ç¨‹åºä¹‹é—´å…±äº«æ•°æ®éå¸¸æœ‰ç”¨ã€‚
- `status`ï¼šHTTP å“åº”çš„ [çŠ¶æ€ä»£ç ](https://developer.mozilla.org/en-US/docs/Web/HTTP/Status)ã€‚åœ¨è°ƒç”¨æ—¶è®¾ç½®çŠ¶æ€ä»£ç ã€‚å§‹ç»ˆè¿”å›çŠ¶æ€ä»£ç ï¼Œå› æ­¤å¯ä»¥ä½¿ç”¨ä¸å¸¦å‚æ•°è°ƒç”¨ `status()` æ¥è¿”å›å½“å‰çŠ¶æ€ä»£ç ã€‚
- `text`ï¼šå‘é€æ–‡æœ¬å“åº”çš„ä¾¿æ·æ–¹æ³•ã€‚å“åº”å°†è‡ªåŠ¨å°† `Content-Type` æ ‡å¤´è®¾ç½®ä¸º `text/plain; charset=utf-8`ã€‚åªèƒ½è°ƒç”¨ä¸€æ¬¡ `text()` å“åº”ã€‚
- `url`ï¼šHTTP è¯·æ±‚çš„ [URL](https://developer.mozilla.org/en-US/docs/Web/API/URL)ã€‚

## é‡å†™è·¯ç”±

æ‚¨å¯ä»¥é‡å†™è·¯å¾„åï¼Œä»¥ä¾¿ä¸ºå¤šä¸ªé¡µé¢é‡ç”¨å•ä¸ªé¡µé¢ç»„ä»¶åŠå…¶è‡ªå·±çš„ä¸­é—´ä»¶å’Œå¸ƒå±€ã€‚
è¿™å¯¹äº SEO ç›®çš„æˆ–å°†é¡µé¢ç¿»è¯‘ä¸ºä¸åŒè¯­è¨€éå¸¸æœ‰ç”¨ã€‚

> **ä½¿ç”¨å‰ç¼€ç¿»è¯‘æœ¬åœ°åŒ–çš„ URLï¼š**
>
> ä¸ºäº†æœ¬åœ°åŒ–ç›®çš„ï¼Œæ‚¨å¯èƒ½å¸Œæœ›å°†è·¯ç”±ä» `/products` ç¿»è¯‘ä¸º `/it/prodotti` 
> æˆ– `/fr/produits`ï¼Œå°† `/products/product-name` ç¿»è¯‘ä¸º `/it/prodotti/nome-prodotto` æˆ– `/fr/produits/nom-du-produit`ï¼Œ
> è€Œä¸éœ€è¦ä¸ºæ¯ä¸ªè¯­è¨€ç¯å¢ƒåˆ›å»ºå¤šä¸ªè·¯ç”±æ–‡ä»¶ï¼Œè€Œæ˜¯é‡ç”¨ç›¸åŒçš„é¡µé¢ç»„ä»¶ã€å¸ƒå±€ã€ä¸­é—´ä»¶ç­‰ã€‚
>
> å‚æ•°åç§°ä¸ä¼šæ›´æ”¹ï¼Œå› æ­¤å¦‚æœè·¯ç”±æ–‡ä»¶æ˜¯ `/products/[slug]/index.tsx`ï¼ŒURL æ˜¯ `/products/product-name`ã€
> `/it/prodotti/nome-prodotto` æˆ– `/fr/produits/nom-du-produit`ï¼Œæ‚¨å°†æ”¶åˆ°ç›¸åŒçš„è·¯å¾„å‚æ•° `slug`ï¼Œ
> å…¶å€¼ä¸º `product-name`ã€`nome-prodotto` æˆ– `nom-du-produit`ã€‚

> **é‡å†™æ²¡æœ‰å‰ç¼€çš„ URLï¼š**
>
> è¿™å¾ˆå°‘è§ï¼Œä½†æ‚¨å¯èƒ½å¸Œæœ›ä¸ºç›¸åŒè·¯å¾„å…·æœ‰åˆ«åã€‚
> ä¾‹å¦‚ï¼Œæ‚¨å¯èƒ½å¸Œæœ› `/docs` å’Œ `/documents` éƒ½ä»åŒä¸€ä¸ªé¡µé¢ç»„ä»¶å‘ˆç°ï¼Œ
> æˆ–è€…æ‚¨å¯èƒ½å¸Œæœ›å°† `/products` ç¿»è¯‘ä¸º `/prodotti` è€Œä¸æ·»åŠ  `/it` å‰ç¼€ã€‚

å¯¹äº routes ä¸‹çš„æ¯ä¸ªæ–‡ä»¶å¤¹ï¼Œå¦‚æœ pathname ä¸­å­˜åœ¨ `paths` é”®çš„å‡ºç°ï¼Œ
åˆ™å°†å¤åˆ¶è·¯ç”±èŠ‚ç‚¹ï¼Œå°†æ‰€æœ‰ `paths` é”®çš„å‡ºç°æ›¿æ¢ä¸ºç›¸å…³çš„ `paths` å€¼ã€‚
æ‰€æœ‰è·¯å¾„å‚æ•°å°†ä¿ç•™ç›¸åŒçš„åç§°ã€‚å¦‚æœæœ‰å‰ç¼€ï¼Œå®ƒå°†æ·»åŠ åˆ°é‡å†™çš„ pathname çš„å¼€å¤´ã€‚

æ‚¨å¯ä»¥åœ¨ `vite.config.ts` ä¸­è®¾ç½®é‡å†™è§„åˆ™ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š

```tsx
import { defineConfig } from 'vite';
import { qwikCity } from '@builder.io/qwik-city/vite';

export default defineConfig(async () => {
  return {
    plugins: [
      qwikCity({
        rewriteRoutes: [
            {
              paths: {
                  'docs': 'documentation'
              },
            },
            {
              prefix: 'it',
              paths: {
                'docs': 'documentazione',
                'getting-started': 'per-iniziare',
                'products': 'prodotti',
              },
            },
          ],
      }),
    ],
  };
});
```

## é«˜çº§è·¯ç”±

Qwik City è¿˜æ”¯æŒï¼š

- [è·¯ç”±å‚æ•°](/docs/(qwikcity)/advanced/routing/index.mdx)
- [åµŒå¥—å¸ƒå±€](/docs/(qwikcity)/advanced/routing/index.mdx#nested-layout)
- [èœå•](/docs/(qwikcity)/advanced/menu/index.mdx)
- [è¯·æ±‚å¤„ç†](/docs/(qwikcity)/advanced/request-handling/index.mdx)

è¿™äº›å°†åœ¨åé¢è®¨è®ºã€‚
